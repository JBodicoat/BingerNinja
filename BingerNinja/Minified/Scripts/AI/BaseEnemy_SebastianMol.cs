using System.Collections;using System.Collections.Generic;using UnityEngine;using UnityEngine.Tilemaps;public enum WW { WE, WR, WT, WY };public enum WU { WI, WO, WP, WA, WS, WD, WF, WG, WH, WJ, WK, WL };public enum WZ { WX, WC, WV, WB };abstract class BaseEnemy_SebastianMol : M{public Transform a;public Transform b;public PolygonCollider2D D;public bool F = false;public WW Q = WW.WE;public WU W;public GameObject E;public GameObject R;public Inventory_JoaoBeijinho T;public float Y;public GameObject U;public float I;public float O;public bool P = false;public Tilemap G;public Transform[] H;public float J;public float K;public bool L;public float Z;float m = 0.5f;public float X;public float C;public float V;public float B = 1f;public float N = 2;public float M = 0.3f;public float QQ = 3;public bool QW = true;public float QE = 1.5f;internal float QR;Pathfinder_SebastianMol q;protected List<Vector2Int> QT = new List<Vector2Int>();protected Transform QY;protected float QU;Vector3 w;protected Vector3 QI;protected float QO;protected float QP;protected int QA = 0;protected float QS;int e;float r;Transform t;Vector3 y;protected bool QD = false;float u;bool i = false;Vector3 o;protected int QF = 1;HitEffectElliott aa;CameraShakeElliott s;protected bool QG = false;PlayerSpoted_Elliott d;protected PlayerStealth_JoaoBeijinho QH;int f = 1 << 8;void g(){if (L){WM();}else {D.enabled = true;if (Vector2.Distance(transform.position, QI) > 0.5f){EQ(QI);}if(Vector2.Distance(transform.position, QI) <= 0.5f) transform.localScale = new Vector3(QU, transform.localScale.y, transform.localScale.z);}QG = false;}void h(){if (EW()){if (Vector2.Distance(transform.position, QY.position) < V / B){EE(false);Q = WW.WT;}else {EQ(QY.position);}}else {ER();i = true;if (QT.Count == 0){if (QP <= 0){i = false;Q = WW.WE;F = false;}else {j();QP -= Time.deltaTime;}}}}void j(){if(m <= 0){if(transform.localScale.x > 0){transform.localScale = new Vector3(-QU, transform.localScale.y, transform.localScale.z);}else {transform.localScale = new Vector3(QU, transform.localScale.y, transform.localScale.z);}m = u;}else {m -= Time.deltaTime;}}abstract internal void ET();void k(){if (EW()){if (Vector2.Distance(transform.position, QY.position) < V){ET();}else {Q = WW.WR;}QP = Z;F = true;}else {F = false;if (QP <= 0){Q = WW.WE;}else {QP -= Time.deltaTime;}}}void l(){if (Vector2.Distance( transform.position, o) < 1 )if (QP <= 0){Q = WW.WE;QP = Z;}else {QP -= Time.deltaTime;ER();}}void z(){switch (Q){case WW.WE:g();break;case WW.WR:h();break;case WW.WT:k();break;case WW.WY:l();break;}}protected void EY(GameObject EI){if(EI.CompareTag("Player")){PlayerStealth_JoaoBeijinho EU = EI.GetComponent<PlayerStealth_JoaoBeijinho>();if (W == WU.WF){if(!EU.H()){x(EI);}}else if(!EU.F()){x(EI);}}}void x(GameObject EO){D.enabled = false;RaycastHit2D EP = Physics2D.Linecast(a.position, EO.transform.position);if (!QH.G() && EP.collider.gameObject.CompareTag(Tags_JoaoBeijinho.m_playerTag)){F = true;QY = EP.transform;Q = WW.WT;EA();EE();}else {D.enabled = true;}}protected bool EW(){if (QY){D.enabled = false;RaycastHit2D ES = Physics2D.Linecast(a.position, QY.position);if (ES.collider.gameObject.CompareTag("Player")){D.enabled = false;return true;}else {RaycastHit2D ED = Physics2D.Linecast(b.position, QY.position);if (ED.collider.gameObject.CompareTag("Player")){D.enabled = false;return true;}else {D.enabled = true;return false;}}}return false;}protected void EF(Vector3 EG){Vector2Int EH = (Vector2Int)q.m_tileMap.WorldToCell(transform.position);Vector2Int EJ = (Vector2Int)q.m_tileMap.WorldToCell(EG);QT = q.PathFind(EH, EJ);if(P){for (int i = 0; i < QT.Count; i++){G.SetTileFlags(new Vector3Int(QT[i].x, QT[i].y, 0), TileFlags.None);G.SetColor(new Vector3Int(QT[i].x, QT[i].y, 0), Color.green);}}}protected void EK(){if (QT.Count == 0) return;float EL = O * Time.deltaTime;while (EL > 0){Vector2 EZ = (Vector2)q.m_tileMap.CellToWorld(new Vector3Int( QT[0].x, QT[0].y, 0)) + ((Vector2)q.m_tileMap.cellSize / 2);EZ += new Vector2(-0.5f, 0);float EX = Vector2.Distance(transform.position, EZ);if (EX > EL){transform.position = Vector2.MoveTowards(transform.position, EZ, EL);EL = 0;}else{transform.position = Vector2.MoveTowards(transform.position, EZ, EX);EL -= EX;if (P) G.SetColor(new Vector3Int(QT[0].x, QT[0].y, 0), Color.white);QT.RemoveAt(0);if (QT.Count == 0) break;}}}protected void EE(bool EC = true){if (P){for (int i = 0; i < QT.Count; i++){G.SetColor(new Vector3Int(QT[i].x, QT[i].y, 0), Color.white);}}QT.Clear();if(EC) QT.Add((Vector2Int)q.m_tileMap.WorldToCell(transform.position));y = Vector3.zero;}protected void WM(){if (t == null) return;if (t.position.x == 0 && t.position.y == 0) t = H[0];if (QT.Count == 0) EF(H[QA].position);if (Vector2.Distance(transform.position, H[QA].position) <= 0.4f) EV();EK();}protected void EV(){if(H.Length > 0){if (r <= 0){if (QA == e){QA = 0;t = H[QA];}else {t = H[++QA];}r = K;}else {r -= Time.deltaTime;}}}protected void EQ(Vector3 pos){if (QT.Count == 0){EF(pos);}if (y == Vector3.zero){y = pos;}if (Vector2.Distance(y, pos) > J){EE();EF(pos);}EK();}public void EB(){if(I <= 0){PlayTrack_Jann.Instance.EM(AudioFiles.Sound_Damage);if (U){Instantiate(U, transform.position, Quaternion.identity);}gameObject.SetActive(false);T.EN();}}protected void RQ(){if(!i)if(F){if(QY.position.x > transform.position.x){transform.localScale = new Vector3( -QU, transform.localScale.y, transform.localScale.z);}else {transform.localScale = new Vector3(QU, transform.localScale.y, transform.localScale.z);}}else {if(w.x > transform.position.x){transform.localScale = new Vector3(QU, transform.localScale.y, transform.localScale.z);}else if(w.x < transform.position.x){transform.localScale = new Vector3(-QU, transform.localScale.y, transform.localScale.z);}w = transform.position;}}public void RW(WZ RE, float RR){switch (W){case WU.WI:v(RR);break;case WU.WO:if (RE == WZ.WX){v(RR * 1.5f);}else {v(RR);}break;case WU.WL:break;case WU.WP:if(QY.position.x < transform.position.x){if(transform.localScale.x < 0) v(RR);}else if(QY.position.x > transform.position.x){if (transform.localScale.x > 0) v(RR);}else {v(RR*0.25f);}break;case WU.WS:if (RE == WZ.WX){if(F == false){v(RR);}else{v(RR * 0.5f);}}else {v(RR);}break;case WU.WD:case WU.WA:Debug.Log(F);if (F == false){I -= RR * (X + C);aa.RT(true);}else {I -= RR;aa.RT(false);}break;case WU.WJ:if ((I / QR) <= M){v(RR);QO *= QE;QW = false;C = 0;}else {if (F == false){I -= RR * (X + C);aa.RT(true);}else {I -= RR;aa.RT(false);}}break;case WU.WK:float RY = I / QR;if (RY > 0.6f){QF = 1;v(RR);}else if( RY > 0.3f){QF = 2;I -= RR;}else {QF = 3;I -= RR;}break;default:v(RR);break;}Q = WW.WR;EB();}void c(){QD = !QD;}public IEnumerator RU(float RI){c();yield return new WaitForSeconds(RI);c();}public void RO(float RP){if(W != WU.WG) SC(RU(RP));}public void RA(float RS){SC(RU(RS));}void v( float RD ){if (F == false){I -= RD * X;s.RF();aa.RT(true);T.RG(ItemType.NinjaPoints, 1);}else {I -= RD;aa.RT(false);}}public void RH(Vector3 pos){EE(false);Q = WW.WY;o = pos;EQ(o);}public void EA(){GameObject RK = Instantiate(R, new Vector3(transform.position.x,transform.position.y + Y,transform.position.z), Quaternion.identity);RK.transform.parent = transform;}public void ER(){if (!QG){GameObject A = Instantiate(E, new Vector3(transform.position.x, transform.position.y + Y, transform.position.z), Quaternion.identity);A.transform.parent = transform;QG = true;}}public void RJ(){transform.position = QI;i = false;Q = WW.WE;F = false;QP = Z;ER();}void Start(){q = FOT<Pathfinder_SebastianMol>();QU = transform.localScale.x;w = transform.position;QI = transform.position;e = H.Length-1;r = K;if (H.Length > 0) t = H[0];u = m;QR = I;QP = Z;QS = V;T = F("Player").GetComponent<Inventory_JoaoBeijinho>();QH = FOT<PlayerStealth_JoaoBeijinho>();aa = GetComponent<HitEffectElliott>();s = Camera.main.GetComponent<CameraShakeElliott>();}void Update(){if(!QD){z();EK();RQ();}}void OnTriggerEnter2D(Collider2D RL){if(!QD)if(!F){EY(RL.gameObject);}}void OnTriggerStay2D(Collider2D RZ){if (!QD)if (!F){EY(RZ.gameObject);}}}